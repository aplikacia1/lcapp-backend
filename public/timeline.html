<!DOCTYPE html> 
<html lang="sk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Li≈°tobook ‚Äì ƒåasov√° os</title>
  <link rel="stylesheet" href="style.css"/>

  <meta name="description" content="Li≈°tobook ‚Äì komunita majstrov v oblasti l√≠≈°t, recenzie, fotky, koment√°re, sk√∫senosti.">
  <meta name="keywords" content="li≈°tov√© centrum, li≈°ty, mont√°≈æ l√≠≈°t, recenzie, sk√∫senosti, komunita, ƒçasov√° os">
  <meta name="author" content="Li≈°tov√© centrum">

  <style>
    /* ‚Ä¶ (cel√© tvoje CSS zo s√∫boru, nemenil som niƒç) ‚Ä¶ */
  </style>

  <link rel="stylesheet" href="/css/timeline.comment-fix.css?v=fixA1">
</head>
<body>

  <input type="checkbox" id="navToggle" class="nav-toggle" aria-hidden="true" />
  <input type="checkbox" id="peopleToggle" class="people-toggle" aria-hidden="true" />

  <header class="app-header" role="banner">
    <div class="app-header-inner">
      <button type="button" class="burger" aria-label="Menu" id="burgerBtn">
        <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M3 6h18M3 12h18M3 18h18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
      </button>

      <button type="button" class="people" aria-label="√öƒçastn√≠ci" id="peopleBtn">
        <svg viewBox="0 0 24 24" fill="none" aria-hidden="true"><circle cx="9" cy="8" r="3" stroke="currentColor" stroke-width="2"/><path d="M2 20c0-3.5 3-6 7-6" stroke="currentColor" stroke-width="2" stroke-linecap="round"/><circle cx="17" cy="10" r="2" stroke="currentColor" stroke-width="2"/><path d="M14 20c0-2.2 1.8-4 4-4" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
      </button>

      <img src="logo_lc.jpg" alt="Li≈°tov√© centrum" class="logo-small">
      <div class="user-chip" id="loggedUser">Prihl√°sen√Ω ako: </div>

      <nav class="nav-scroller" aria-label="Hlavn√© sekcie">
        <div class="nav-track">
          <button class="pill" id="goBackBtn">Centrum hodnotenia</button>
          <span id="msgBadge" style="display:none; min-width:18px; height:18px; padding:0 6px; border-radius:999px; background:#ffcc00; color:#111; font-weight:800; font-size:12px; display:inline-flex; align-items:center; justify-content:center;"></span>
          <button class="pill" id="gameBtn">Centrum z√°bavy</button>
          <button class="pill" id="accountBtn">Centrum zmeny √∫ƒçtu</button>
          <button class="pill pill-danger" id="logoutBtn">Odhl√°si≈• sa</button>
        </div>
      </nav>
    </div>
  </header>

  <div class="neon-beams" aria-hidden="true">
    <span class="beam left"></span>
    <span class="beam right"></span>
    <span class="glow left"></span>
    <span class="glow right"></span>
  </div>

  <aside id="presencePanel" class="presence-panel">
    <div class="presence-title">Pou≈æ√≠vatelia</div>
    <div class="presence-hint">≈§ukni na meno pre <strong>nov√∫ konverz√°ciu</strong>.</div>
    <ul id="presenceList" class="presence-list"></ul>
  </aside>

  <div class="main-content">
    <div class="post-feed" id="postFeed"></div>
  </div>

  <div class="composer-bar" id="composerBar">
    <div class="composer-wrap">
      <form id="timelineForm" class="composer" autocomplete="off" enctype="multipart/form-data">
        <div class="composer-row">
          <div class="input-group">
            <input id="postContent" class="composer-input" type="text" placeholder="Nap√≠≈° nieƒço..." maxlength="300" data-preserve />
            <span id="composerCount">0 / 300</span>
            <input id="postImage" type="file" accept="image/*" hidden />
          </div>
          <button type="button" id="postImageBtn" class="button button--icon" aria-label="Prida≈• obr√°zok">üìé</button>
          <button id="postSubmit" class="button" type="submit" disabled>Odosla≈•</button>
        </div>
      </form>

      <div id="miniBannerSlot" class="mini-banner" aria-live="polite"></div>

      <div id="desktopInfo" class="desktop-infobar" role="contentinfo">
        Li≈°tobook by Li≈°tov√© centrum EU, s.r.o. ¬©, Sasinkova 13, 010 01 ≈Ωilina ‚Äî 2025, verzia 1.0
      </div>
    </div>
  </div>

  <div id="toastStack" class="toast-stack" aria-live="polite" aria-atomic="true"></div>

  <a class="brand-badge" href="#" aria-label="MarSab¬Æ">
    <img src="img/marsab_logo.png" alt="">
    <span class="wordmark">MarSab¬Æ</span>
  </a>

  <script src="/js/config.js"></script>
  <script src="/js/unread-badge.js"></script>
  <script src="timeline.js"></script>
  <script src="banners.js"></script>

  <script>
    function mountBannerMobileOnly(slotId, options){
      const mql  = window.matchMedia('(max-width: 991.98px)');
      const slot = document.getElementById(slotId);
      if (!slot) return;

      function mount(){
        if (slot.dataset.mounted || !window.mountBannerRotator) return;
        slot.style.display = '';
        window.mountBannerRotator(slotId, options);
        slot.dataset.mounted = '1';
      }
      function unmount(){
        slot.innerHTML = '';
        slot.style.display = 'none';
        delete slot.dataset.mounted;
      }
      function update(){ mql.matches ? mount() : unmount(); }

      update();
      if (mql.addEventListener) mql.addEventListener('change', update);
      else mql.addListener(update);
    }
  </script>

  <!-- Helpery + navig√°cia + hamburgre + mount mini banner (MOBILE ONLY) -->
  <script>
    (function(){
      const stack = document.getElementById('toastStack');
      const MAX = 3;
      const ESC = s => String(s||'').replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[m]));
      const icons = { success:'‚úì', info:'‚ÑπÔ∏é', warn:'!', error:'√ó' };

      function push(type='info', message='', {duration=4000}={}){
        if (!stack) return;
        while (stack.children.length >= MAX) stack.firstElementChild?.remove();
        const el = document.createElement('div');
        el.className = `toast ${type}`;
        el.innerHTML = `
          <div class="t-ico">${icons[type]||'‚ÑπÔ∏é'}</div>
          <div class="t-msg">${ESC(message)}</div>
          <button class="t-x" aria-label="Zavrie≈•">√ó</button>
        `;
        stack.appendChild(el);
        const killer = setTimeout(()=> el.remove(), duration);
        el.querySelector('.t-x')?.addEventListener('click', () => { clearTimeout(killer); el.remove(); });
      }
      window.toast = {
        show: (type, msg, opts) => push(type, msg, opts),
        success: (msg, opts) => push('success', msg, opts),
        info:    (msg, opts) => push('info', msg, opts),
        warn:    (msg, opts) => push('warn', msg, opts),
        error:   (msg, opts) => push('error', msg, opts),
      };
    })();

    document.addEventListener('DOMContentLoaded', () => {
      const header = document.querySelector('.app-header');
      const setHdrH = () => {
        if (!header) return;
        const h = header.getBoundingClientRect().height;
        document.documentElement.style.setProperty('--hdr-h', h + 'px');
      };
      setHdrH(); window.addEventListener('resize', setHdrH);

      const email = new URLSearchParams(window.location.search).get("email");
      const go = (page) => { window.location.href = email ? `${page}?email=${encodeURIComponent(email)}` : page; };

      document.getElementById('goBackBtn')?.addEventListener('click', () => go('catalog.html'));
      document.getElementById('logoutBtn')?.addEventListener('click', () => { window.location.href = 'index.html'; });
      document.getElementById('gameBtn')?.addEventListener('click', () => go('game.html'));
      document.getElementById('accountBtn')?.addEventListener('click', () => go('dashboard.html'));

      // Klik na √∫ƒçastn√≠ka ‚Üí s√∫kromn√° spr√°va podƒæa prez√Ωvky
      const presence = document.getElementById('presenceList');
      presence?.addEventListener('click', (e) => {
        const li = e.target.closest('.presence-item');
        if (!li) return;
        const toName = (li.dataset.name || '').trim();
        if (!toName) return;
        const url = `messages.html?email=${encodeURIComponent(email || '')}&to=${encodeURIComponent(toName)}`;
        window.location.href = url;
      });

      // Mini banner: iba mobil
      mountBannerMobileOnly('miniBannerSlot', {
        fixed: false,
        interval: 7000,
        height: 80,
        heightMobile: 90
      });
    });
  </script>

  <!-- üîß MOBIL: hamburger + panel pou≈æ√≠vateƒæov -->
  <script>
    (function(){
      const navChk = document.getElementById('navToggle');
      const pplChk = document.getElementById('peopleToggle');
      const burger = document.getElementById('burgerBtn');
      const people = document.getElementById('peopleBtn');

      if (!navChk || !pplChk || !burger || !people) return;

      const anyOpen = () => !!(navChk.checked || pplChk.checked);
      const updateScrollLock = () => document.body.classList.toggle('no-scroll', anyOpen());

      burger.addEventListener('click', (e) => {
        e.stopPropagation();
        navChk.checked = !navChk.checked;
        if (navChk.checked) pplChk.checked = false;
        updateScrollLock();
      });

      people.addEventListener('click', (e) => {
        e.stopPropagation();
        pplChk.checked = !pplChk.checked;
        if (pplChk.checked) navChk.checked = false;
        updateScrollLock();
      });

      document.addEventListener('click', (e) => {
        const inHeader = e.target.closest('.app-header');
        const inLeft   = e.target.closest('.nav-scroller');
        const inRight  = e.target.closest('.presence-panel');
        if (!inHeader && !inLeft && !inRight) {
          navChk.checked = false;
          pplChk.checked = false;
          updateScrollLock();
        }
      }, { passive:true });

      ['change','input'].forEach(ev => {
        navChk.addEventListener(ev, updateScrollLock);
        pplChk.addEventListener(ev, updateScrollLock);
      });
    })();
  </script>
</body>
</html>
